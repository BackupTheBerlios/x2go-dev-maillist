<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-dev] remote proxy closed the connection
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-dev/2011-February/index.html" >
   <LINK REL="made" HREF="mailto:x2go-dev%40lists.berlios.de?Subject=Re%3A%20%5BX2go-dev%5D%20remote%20proxy%20closed%20the%20connection&In-Reply-To=%3C1296856457.30871.56.camel%40denise.theartistscloset.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001720.html">
   <LINK REL="Next"  HREF="001711.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-dev] remote proxy closed the connection</H1>
    <B>John A. Sullivan III</B> 
    <A HREF="mailto:x2go-dev%40lists.berlios.de?Subject=Re%3A%20%5BX2go-dev%5D%20remote%20proxy%20closed%20the%20connection&In-Reply-To=%3C1296856457.30871.56.camel%40denise.theartistscloset.com%3E"
       TITLE="[X2go-dev] remote proxy closed the connection">jsullivan at opensourcedevel.com
       </A><BR>
    <I>Fri Feb  4 22:54:17 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001720.html">[X2go-dev] remote proxy closed the connection
</A></li>
        <LI>Next message: <A HREF="001711.html">[X2go-dev] remote proxy closed the connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1710">[ date ]</a>
              <a href="thread.html#1710">[ thread ]</a>
              <a href="subject.html#1710">[ subject ]</a>
              <a href="author.html#1710">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 2011-02-04 at 16:14 -0500, Gerry Reno wrote:
&gt;<i> On 02/02/2011 09:48 PM, Gerry Reno wrote:
</I>&gt;<i> &gt; On 02/02/2011 09:35 PM, Gerry Reno wrote:
</I>&gt;<i> &gt;   
</I>&gt;<i> &gt;&gt; I'm seeing the following errors trying to connect to a new machine
</I>&gt;<i> &gt;&gt; running server version 3.0.99 using the browser client:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine su[16393]: pam_unix(su:session): session
</I>&gt;<i> &gt;&gt; opened for user ubuntu by (uid=0)
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sudo:   ubuntu : TTY=unknown ; PWD=/ ;
</I>&gt;<i> &gt;&gt; USER=root ; COMMAND=/usr/bin/touch /root/firstlogin_done
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16319]: Accepted publickey for ubuntu
</I>&gt;<i> &gt;&gt; from XXX.XXX.XXX.XXX port 51610 ssh2
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16319]: pam_unix(sshd:session): session
</I>&gt;<i> &gt;&gt; opened for user ubuntu by (uid=0)
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16320]: Accepted publickey for ubuntu
</I>&gt;<i> &gt;&gt; from XXX.XXX.XXX.XXX port 51609 ssh2
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16320]: pam_unix(sshd:session): session
</I>&gt;<i> &gt;&gt; opened for user ubuntu by (uid=0)
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16441]: error: bind: Address already in use
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16441]: error:
</I>&gt;<i> &gt;&gt; channel_setup_fwd_listener: cannot listen to port: 30008
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16234]: pam_unix(sshd:session): session
</I>&gt;<i> &gt;&gt; closed for user ubuntu
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine su[16393]: pam_unix(su:session): session
</I>&gt;<i> &gt;&gt; closed for user ubuntu
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16524]: error: connect_to localhost port
</I>&gt;<i> &gt;&gt; 30007: failed.
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16232]: pam_unix(sshd:session): session
</I>&gt;<i> &gt;&gt; closed for user ubuntu
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[29561]: channel 2: open failed: connect
</I>&gt;<i> &gt;&gt; failed: Connection refused
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sudo:   ubuntu : TTY=unknown ;
</I>&gt;<i> &gt;&gt; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/touch /root/firstlogin_done
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sudo:   ubuntu : TTY=unknown ;
</I>&gt;<i> &gt;&gt; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/touch /root/firstlogin_done
</I>&gt;<i> &gt;&gt; Feb  3 02:20:33 newmachine sshd[16233]: pam_unix(sshd:session): session
</I>&gt;<i> &gt;&gt; closed for user ubuntu
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; The client reports:
</I>&gt;<i> &gt;&gt;     Resuming
</I>&gt;<i> &gt;&gt;     Aborting
</I>&gt;<i> &gt;&gt;     Error message appears:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     The remote proxy closed the connection while negotiating
</I>&gt;<i> &gt;&gt;     the session. This may be due to the wrong authentication
</I>&gt;<i> &gt;&gt;     credentials passed to the server.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     Finished
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I ran a check for sessions and there is only one existing session.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I've triple-checked the credentials and logged in on command line using
</I>&gt;<i> &gt;&gt; them.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;   
</I>&gt;<i> &gt;&gt;     
</I>&gt;<i> &gt; Here's what we have for x2go processes:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ubuntu    3219     1  0 Feb02 ?        00:00:50 /usr/lib/x2go/x2goagent
</I>&gt;<i> &gt; -dpi 96 -D -auth /home/ubuntu/.Xauthority -geometry 1005x552+113+232
</I>&gt;<i> &gt; -name X2GO-ubuntu-51-1296672519_stDGNOME_dp24 :51
</I>&gt;<i> &gt; ubuntu    3690     1  0 Feb02 ?        00:00:00 /bin/bash
</I>&gt;<i> &gt; /usr/bin/x2goruncommand 51 3219 ubuntu-51-1296672519_stDGNOME_dp24 30008
</I>&gt;<i> &gt; gnome-session nosnd D
</I>&gt;<i> &gt; root     15119     1  0 Feb02 ?        00:00:04 /usr/bin/perl
</I>&gt;<i> &gt; /usr/sbin/x2gocleansessions
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So there is an existing session.  I got detached from it when the
</I>&gt;<i> &gt; browser crashed.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It seems as though the client should either automatically attach to the
</I>&gt;<i> &gt; session or present the user with the list of sessions to take some action.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt; Gerry
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Has anyone found out how to prevent this &quot;remote proxy closed the
</I>&gt;<i> connection&quot; error from happening when a session becomes detached and a
</I>&gt;<i> user tries to resume the session?
</I>&gt;<i> 
</I>&gt;<i> We are seeing this problem quite often and every once in a while you can
</I>&gt;<i> get it to resume but mostly this session is unrecoverable and must be
</I>&gt;<i> manually terminated - which is creating much sysadmin work.
</I>&lt;snip&gt;
Interesting - we have seen a lot of this, too, and had just assumed it
was an error in the substantial customizations we had made to the
scripts. We have noticed that, when users are cutoff, e.g., the Internet
connection drops, they are presented with a list of running sessions
when they reconnect but attaching to a running session almost never
works.

We have a related nightmare of a problem with a user running Windows XP
on a very old computer who can almost never successfully connect.
Sometimes the session starts and then never completes.  We can see the
&quot;running&quot; session in the database but we know the session has not
started because the memory in the vserver is only 20MB - i.e., no KDE.
The same user is constantly getting incorrect password errors to the
point that OSSEC locks them out of any communication with the X2Go
Server.  This is no matter how carefully we enter the password.

We have been assuming this last problem has something to do with timing,
i.e., the computer takes so long to respond that something times out and
is considered a wrong password.  We have great hopes that the new client
using libssh will respond more quickly and solve this problem as we
suspect it will be much faster working directly with the Windows network
stack than Cygwin shimming its own between the application and the
Windows stack as well as adding its own overhead to a very slow
computer.  I hope we will find out this weekend when we try putting this
user on our experimental vcxsrv/libssh version - John


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001720.html">[X2go-dev] remote proxy closed the connection
</A></li>
	<LI>Next message: <A HREF="001711.html">[X2go-dev] remote proxy closed the connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1710">[ date ]</a>
              <a href="thread.html#1710">[ thread ]</a>
              <a href="subject.html#1710">[ subject ]</a>
              <a href="author.html#1710">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-dev">More information about the X2Go-Dev
mailing list</a><br>
</body></html>
