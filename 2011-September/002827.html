<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-Dev] X2Go printing crash [was: libssh, nagle, and performance issues]
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-dev/2011-September/index.html" >
   <LINK REL="made" HREF="mailto:x2go-dev%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Dev%5D%20X2Go%20printing%20crash%20%5Bwas%3A%20libssh%2C%20nagle%2C%0A%20and%20performance%20issues%5D&In-Reply-To=%3C1316638549.1082.153.camel%40denise.theartistscloset.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002822.html">
   <LINK REL="Next"  HREF="002828.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-Dev] X2Go printing crash [was: libssh, nagle, and performance issues]</H1>
    <B>John A. Sullivan III</B> 
    <A HREF="mailto:x2go-dev%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Dev%5D%20X2Go%20printing%20crash%20%5Bwas%3A%20libssh%2C%20nagle%2C%0A%20and%20performance%20issues%5D&In-Reply-To=%3C1316638549.1082.153.camel%40denise.theartistscloset.com%3E"
       TITLE="[X2go-Dev] X2Go printing crash [was: libssh, nagle, and performance issues]">jsullivan at opensourcedevel.com
       </A><BR>
    <I>Wed Sep 21 22:55:49 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002822.html">[X2go-Dev] libssh, nagle, and performance issues
</A></li>
        <LI>Next message: <A HREF="002828.html">[X2go-Dev] X2Go printing crash [was: libssh, nagle, and performance issues]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2827">[ date ]</a>
              <a href="thread.html#2827">[ thread ]</a>
              <a href="subject.html#2827">[ subject ]</a>
              <a href="author.html#2827">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 2011-09-20 at 20:15 +0200, Mike Gabriel wrote:
&gt;<i> Hi John,
</I>&gt;<i> 
</I>&gt;<i> On Di 20 Sep 2011 18:27:24 CEST &quot;Jhn A. Sullivan III&quot; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; &lt;snip&gt;
</I>&gt;<i> &gt; I doubt it as the problem is one the client side and not the server
</I>&gt;<i> &gt; side.  All our changes were to the server.  This is in the Squeeze
</I>&gt;<i> &gt; client and not Windows - John
</I>&gt;<i> 
</I>&gt;<i> 1.
</I>&gt;<i> Does the problem disappear with the latest x2goclient (built today  
</I>&gt;<i> around 4pm CEST).
</I>&gt;<i> 
</I>&gt;<i> 2.
</I>&gt;<i> Can you send me the ,,printing'' config file in ~/.x2goclient?
</I>&gt;<i> 
</I>&gt;<i> 3.
</I>&gt;<i> Can you send me /etc/cups/printers.conf?
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> Mike
</I>&lt;snip&gt;
Just tried.  It still crashes.  Here is /etc/cups/printers.conf:
# Printer configuration file for CUPS v1.4.4
# Written by cupsd
# DO NOT EDIT THIS FILE WHEN CUPSD IS RUNNING
&lt;DefaultPrinter HP_2605dn&gt;
Info HP2605dn
Location Kennebunk
MakeModel HP Color LaserJet 2605dn Foomatic/Postscript
DeviceURI <A HREF="socket://192.168.223.99:9100">socket://192.168.223.99:9100</A>
State Idle
StateTime 1311624159
Type 8400924
Filter application/vnd.cups-raw 0 -
Filter application/vnd.cups-postscript 100 foomatic-rip
Filter application/vnd.cups-pdf 0 foomatic-rip
Accepting Yes
Shared No
JobSheets none none
QuotaPeriod 0
PageLimit 0
KLimit 0
OpPolicy default
ErrorPolicy stop-printer
&lt;/Printer&gt;

and here is .x2goclient/printing:
[General]
showdialog=true
pdfview=false

[print]
startcmd=false
command=lpr
stdin=false
ps=false

[view]
open=true
command=kpdf

[CUPS]
defaultprinter=HP_2605dn
options\HP2605=&quot;Duplex=DuplexTumble&quot;, &quot;HPColorSmart=Manual&quot;,
&quot;ColorModel=Gray1200x1200dpi&quot;
options\HP2605dn=&quot;Duplex=DuplexNoTumble&quot;,
&quot;CMAndResolution=Gray600x600dpi&quot;
options\HP_2605dn=&quot;Duplex=DuplexNoTumble&quot;

I took an strace but it does not reveal a lot.  Here are pertinent
sections from the end of x2gotrace.3420:

time(NULL)                              = 1316637069
time(NULL)                              = 1316637069
recv(29, &quot;-hold-until-default\0\7no-hold!\0\24j&quot;..., 2048, 0) = 2048
time(NULL)                              = 1316637069
recv(29, &quot;utionD\0\0\0\5sidesD\0\30job-hold-until&quot;..., 2048, 0) = 2048
time(NULL)                              = 1316637069
recv(29, &quot;\4\0\0\0&amp;#\0\0\0\4\0\0@\1#\0\0\0\4\0\0@\2#\0\0\0\4\0\0@\3&quot;...,
448, 0) = 448
time(NULL)                              = 1316637069
open(&quot;/etc/cups/lpoptions&quot;, O_RDONLY|O_LARGEFILE) = -1 ENOENT (No such
file or directory)
access(&quot;/home/jsullivan/.cups/lpoptions&quot;, F_OK) = -1 ENOENT (No such
file or directory)
open(&quot;/home/jsullivan/.lpoptions&quot;, O_RDONLY|O_LARGEFILE) = -1 ENOENT (No
such file or directory)
stat64(&quot;/home/jsullivan/.x2goclient/printing&quot;, {st_mode=S_IFREG|0755,
st_size=369, ...}) = 0
open(&quot;/home/jsullivan/.x2goclient/printing&quot;, O_RDONLY|O_LARGEFILE|
O_CLOEXEC) = 31
fcntl64(31, F_SETFD, FD_CLOEXEC)        = 0
fstat64(31, {st_mode=S_IFREG|0755, st_size=369, ...}) = 0
close(31)                               = 0
stat64(&quot;/home/jsullivan/.x2goclient/printing&quot;, {st_mode=S_IFREG|0755,
st_size=369, ...}) = 0
stat64(&quot;/home/jsullivan/.x2goclient/printing&quot;, {st_mode=S_IFREG|0755,
st_size=369, ...}) = 0
stat64(&quot;/etc/localtime&quot;, {st_mode=S_IFREG|0644, st_size=3519, ...}) = 0
stat64(&quot;/etc/cups/ppd/HP_2605dn.ppd&quot;, {st_mode=S_IFREG|0644,
st_size=9953, ...}) = 0
gettimeofday({1316637069, 848633}, NULL) = 0
symlink(&quot;/etc/cups/ppd/HP_2605dn.ppd&quot;, &quot;/tmp/4e7a498dcf2f9&quot;) = 0
open(&quot;/tmp/4e7a498dcf2f9&quot;, O_RDONLY|O_LARGEFILE) = 31
fcntl64(31, F_GETFD)                    = 0
fcntl64(31, F_SETFD, FD_CLOEXEC)        = 0
read(31, &quot;*PPD-Adobe: \&quot;4.3\&quot;\n*%\n*% For info&quot;..., 4096) = 4096
read(31, &quot;\n*PageRegion Letter/US Letter: \&quot;&quot;..., 4096) = 4096
read(31, &quot;Standard \&quot;(001.004S)\&quot; Standard R&quot;..., 4096) = 1761
read(31, &quot;&quot;, 4096)                      = 0
read(31, &quot;&quot;, 4096)                      = 0
close(31)                               = 0
unlink(&quot;/tmp/4e7a498dcf2f9&quot;)            = 0
stat64(&quot;/home/jsullivan/.x2goclient/printing&quot;, {st_mode=S_IFREG|0755,
st_size=369, ...}) = 0
open(&quot;/home/jsullivan/.x2goclient/printing&quot;, O_RDONLY|O_LARGEFILE|
O_CLOEXEC) = 31
fcntl64(31, F_SETFD, FD_CLOEXEC)        = 0
fstat64(31, {st_mode=S_IFREG|0755, st_size=369, ...}) = 0
close(31)                               = 0
stat64(&quot;/home/jsullivan/.x2goclient/printing&quot;, {st_mode=S_IFREG|0755,
st_size=369, ...}) = 0
stat64(&quot;/home/jsullivan/.x2goclient/printing&quot;, {st_mode=S_IFREG|0755,
st_size=369, ...}) = 0
stat64(&quot;/etc/localtime&quot;, {st_mode=S_IFREG|0644, st_size=3519, ...}) = 0
time(NULL)                              = 1316637070
time(NULL)                              = 1316637070
.
.
.
.
time(NULL)                              = 1316637071
time(NULL)                              = 1316637071
clock_gettime(CLOCK_MONOTONIC, {709, 441819023}) = 0
select(13, [12], NULL, NULL, {0, 0})    = 0 (Timeout)
clock_gettime(CLOCK_MONOTONIC, {709, 444143062}) = 0
open(&quot;/home/jsullivan/.x2go/S-jasiii-53-1316636661_stDKDE_dp24/spool&quot;,
O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|O_CLOEXEC) = 31
statfs(&quot;/home/jsullivan/.x2go/S-jasiii-53-1316636661_stDKDE_dp24/spool&quot;,
{f_type=&quot;EXT2_SUPER_MAGIC&quot;, f_bsize=4096, f_blocks=12812451,
f_bfree=11505345, f_bavail=11375175, f_f
getdents(31, /* 3 entries */, 32768)    = 76
stat64(&quot;/home/jsullivan/.x2go/S-jasiii-53-1316636661_stDKDE_dp24/spool/.&quot;, {st_mode=S_IFDIR|0700, st_size=4096, ...}) = 0
stat64(&quot;/home/jsullivan/.x2go/S-jasiii-53-1316636661_stDKDE_dp24/spool/13008-jasiii-cupsjob13904.pdf&quot;, {st_mode=S_IFREG|0644, st_size=23397, ...}) = 0
getdents(31, /* 0 entries */, 32768)    = 0
close(31)                               = 0
stat64(&quot;/home/jsullivan/.x2go/S-jasiii-53-1316636661_stDKDE_dp24/spool/..&quot;, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
clock_gettime(CLOCK_MONOTONIC, {709, 729349572}) = 0
poll([{fd=7, events=POLLIN|POLLOUT}], 1, -1) = 1 ([{fd=7,
revents=POLLOUT}])
writev(7, [{&quot;\224\7\2\0\0\22\200\3\22\0\n\0\377\21\200\3[\1\0\0[\1\0\0
\10\21\200\3\20\0\0\0&quot;..., 96}, {NULL, 0}, {&quot;&quot;, 0}], 3) = 96
read(7, &quot;\34\0\335b\377\21\200\3[\1\0\0\234\324\n\0\0\0\0\0\0\0\0\0\0\0
\0\0\0\0\0\0&quot;..., 4096) = 704
read(7, 0x9bede30, 4096)                = -1 EAGAIN (Resource
temporarily unavailable)
read(7, 0x9bede30, 4096)                = -1 EAGAIN (Resource
temporarily unavailable)
munmap(0xb5b82000, 65932)               = 0
munmap(0xb5ab5000, 633604)              = 0
munmap(0xb5aa6000, 58716)               = 0
munmap(0xb5894000, 584396)              = 0
poll([{fd=7, events=POLLIN|POLLOUT}], 1, -1) = 1 ([{fd=7,
revents=POLLOUT}])
writev(7, [{&quot;\224\7\2\0\31\0\200\3\22\0\n\0\30\0\200\3[\1\0\0[\1\0\0\10
\21\200\3\20\0\0\0&quot;..., 3372}, {NULL, 0}, {&quot;&quot;, 0}], 3) = 3372
poll([{fd=7, events=POLLIN}], 1, -1)    = 1 ([{fd=7, revents=POLLIN}])
read(7, &quot;\34\0\345b\30\0\200\3[\1\0\0N\325\n\0\0\0\0\0\0\0\0\0\0\0\0\0\0
\0\0\0&quot;..., 4096) = 1376
read(7, 0x9bede30, 4096)                = -1 EAGAIN (Resource
temporarily unavailable)
poll([{fd=7, events=POLLIN|POLLOUT}], 1, -1) = 1 ([{fd=7,
revents=POLLIN|POLLOUT}])
read(7, &quot;\26\0\201du\1\200\1u\1\200\1\0\0\0\0\0\0\0\0t\0\36\0\0\0\0\0\0
\0\0\0&quot;, 4096) = 32
writev(7, [{&quot;O\7\2\0\1\0\200\3&lt;\0\2\0\0\0\200\3.\1\2\0\5\0\200\3+\21\1
\0&quot;, 28}, {NULL, 0}, {&quot;&quot;, 0}], 3) = 28
poll([{fd=7, events=POLLIN}], 1, -1)    = 1 ([{fd=7, revents=POLLIN}])
read(7, &quot;\1\1\205d\0\0\0\0\6\0`\3\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0
\0&quot;, 4096) = 32
read(7, 0x9bede30, 4096)                = -1 EAGAIN (Resource
temporarily unavailable)
close(7)                                = 0
write(8, &quot;\1\v\1\0\1\0\0\0\0\0\0\0\0\0\0\0&quot;, 16) = 16
close(8)                                = 0
open(&quot;/proc/stat&quot;, O_RDONLY|O_CLOEXEC)  = 7
read(7, &quot;cpu  53876 11825 26767 40263 127&quot;..., 8192) = 2875
close(7)                                = 0
write(6, &quot;@&quot;, 1)                        = 1
close(6)                                = 0
close(5)                                = 0
rt_sigaction(SIGCHLD, {SIG_DFL, [], SA_NOCLDSTOP}, {0xb68cc3b0, [],
SA_NOCLDSTOP}, 8) = 0
exit_group(0)                           = ?


I tried to intercept it with ddd but that didn't work.  Interestingly,
its messages were that the program closed normally as if x2goprinting is
invoking a close event.  I'll see what I can do to get this to run from
a debugger but it is a showstopping bug for us - John


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002822.html">[X2go-Dev] libssh, nagle, and performance issues
</A></li>
	<LI>Next message: <A HREF="002828.html">[X2go-Dev] X2Go printing crash [was: libssh, nagle, and performance issues]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2827">[ date ]</a>
              <a href="thread.html#2827">[ thread ]</a>
              <a href="subject.html#2827">[ subject ]</a>
              <a href="author.html#2827">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-dev">More information about the X2Go-Dev
mailing list</a><br>
</body></html>
